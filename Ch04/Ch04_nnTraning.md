# Chapter04 신경망 학습

- 이번 장의 주제는 신경망 학습이다.
- 여기서 학습이란 훈련 데이터로부터 가중치 매개변수의 최적값을 자동으로 획득하는 것을 뜻한다.
- 이번 장에서는 신경망이 학습할 수 있도록 해주는 지표인 손실 함수를 소개한다.
- 이 손실 함수의 결괏값을 가장 작게 만드는 가중치 매개변수를 찾는 것이 학습 목표이다.
- 이번 장에서는 손실 함수의 값을 가급적 작게 만드는 기법으로, 함수의 기울기를 활용하는 경사법을 소개한다.

## 4.1 데이터에서 학습한다 !
- 신경망의 특징은 데이터를 보고 학습할 수 있다는 점이다.
- 데이터에서 학습한다는 것은 가중치 매개변수의 값을 데이터를 보고 자동으로 결정한다는 뜻이다.
- 이번 장에서는 신경망 학습(데이터로부터 매개변수의 값을 정하는 방법)에 대하여 설명하고 파이썬으로 
MNIST 데이터셋의 손글씨 숫자를 학습하는 코드를 구현한다.

### 4.1.1 데이터 주도 학습
- 기계학습은 데이터가 생명이다. 데이터에서 답을 찾고 데이터에서 패턴을 발견하고 데이터로 이야기를 만드는 것이
기계학습이다.
- 기계학습에서는 사람의 개입을 최소화하고 수집한 데이터로부터 패턴을 찾으려고 시도해야 한다.
- 기계학습의 두 가지 접근법이 있는데 하나는 사람이 설계를 하여 기계가 학습하는 것이고 나머지 하나는 오직 기계가
처음부터 끝까지 데이터의 특징을 생각해내어 학습한다는 것이다.

<img src="../dataset/mdImage/ch041.png" width="800">

- 이처럼 신경망(딥러닝)은 이미지를 "있는 그대로" 학습한다.
- 두 번째 접근 방식에서는 특징을 사람이 설계했지만, 신경망은 이미지에 포함된 중요한 특징까지도 "기계"가 스스로
학습할 것이다.
- 이러한 이유 때문에 딥러닝을 end-to-end machine learning이라고도 한다. 여기서 end-to-end란 '처음부터
끝까지'라는 의미로, 데이터(입력)에서 목표한 결과(출력)를 사람의 개입 없이 얻는다는 뜻을 담고 있다.
- 신경망의 이점은 모든 문제를 같은 맥락에서 풀 수 있다는 점이다.
- 예를 들어 '5'를 인식하는 문제든, '개'를 인식하는 문제든 세부사항과 관계없이 신경망은 주어진 데이터를 온전히 
학습하여 주어진 문제의 패턴을 발견하려고 시도한다.


### 4.1.2 훈련 데이터와 시험 데이터 
- 기계학습 문제는 데이터를 훈련 데이터(training data)와 시험 데이터(test data)로 나눠 학습과 실험을
수행하는 것이 일반적이다.
- 우선 훈련 데이터만 사용하여 학습하면서 최적의 매개변수를 찾는다. 
- 그런 다음 시험 데이터를 사용하여 앞서 훈련한 모델의 실력을 평가하는 것이다.
- 훈련 데이터와 시험 데이터를 나누는 이유는 우리는 `범용적으로 사용할 수 있는 모델을 원하기 때문이다.`
- 범용 능력을 제대로 평가하기 위해 훈련 데이터와 시험 데이터를 분리하는데, 여기서 `범용 능력이란 아직 보지 못한 데이터
  (훈련 데이터에 포함되지 않는 데이터)로도 문제를 올바르게 풀어내는 능력이다.`
- 즉 기계학습의 최종 목표는 이 범용 능력을 획득하는 것이다.
- 예를 들어, '특정인의 특정 글자'가 아닌 '임의의 사람의 임의의 글자'를 판단하는 모델을 개발해야한다.
- 만약 수중에 있는 훈련 데이터만 잘 판별한다면 그 데이터에 포함된 사람의 글씨체만 학습했을 가능성이 크다.
- 따라서 하나의 데이터셋으로만 학습과 평가를 수행하면 올바른 평가가 될 수 없다. 
- 참고로 한 데이터셋에만 지나치게 최적화된 상태를 `오버피팅(overfitting)`이라고 한다. 오버피팅을 피하는 것이
기계학습의 중요한 과제이기도 하다.


## 4.2 손실 함수
- 신경망 학습에서는 현재의 상태를 '하나의 지표'로 표현한다.
- 그 지표를 가장 좋게 만들어주는 가중치 매개변수의 값을 탐색하는 것이 목표이다.
- 신경망 학습에서 사용하는 지표는 `손실 함수 (loss fuction)`이다.
- 이 손실 함수는 일반적으로 오차제곱합과 교차 엔트로피 오차를 사용한다.
- 이 손실 함수는 '얼마나 나쁘냐'를 기준으로 하므로 이 손실 함수의 값을 0에 가까운 값으로 학습시키는 것이 목표이다.

### 4.2.1 오차제곱합 (sum of squares for error, SSE)
- 가장 많이 쓰이는 손실 함수는 오차제곱합이며 수식은 다음과 같다.

$$
E = \\frac{1}{2} \\sum_{i}(y_{i} - t_{i})^2
$$

- 
